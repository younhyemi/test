<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>ê´€ë¦¬ì í˜ì´ì§€</title>
  <link rel="stylesheet" href="/styles/common.css">
  <style>
    .admin-container {
      padding: 24px 16px;
    }
    
    .admin-title {
      font-size: 24px;
      font-weight: bold;
      margin-bottom: 32px;
      text-align: center;
      color: #333;
    }
    
    .menu-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
    }
    
    .menu-item {
      background: white;
      border-radius: 12px;
      padding: 24px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      text-align: center;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    
    .menu-item:active {
      transform: scale(0.98);
    }
    
    .menu-item-icon {
      font-size: 48px;
      margin-bottom: 12px;
    }
    
    .menu-item-title {
      font-size: 18px;
      font-weight: 600;
      color: #333;
    }
  </style>
</head>
<body>
  <div class="admin-container">
    <h1 class="admin-title">ê´€ë¦¬ì í˜ì´ì§€</h1>
    
    <div class="menu-grid" id="menuGrid">
      <!-- ë©”ë‰´ê°€ ë™ì ìœ¼ë¡œ ë¡œë“œë©ë‹ˆë‹¤ -->
    </div>
  </div>

  <script type="module">
    import { supabase } from '/config/supabase.js';

    // í™”ë©´ ëª©ë¡ ë¡œë“œ ë° í‘œì‹œ
    async function loadMenuItems() {
      try {
        const { data, error } = await supabase
          .from('screen_management')
          .select('*')
          .eq('use_yn', 'Y')
          .order('display_order', { ascending: true });

        if (error) throw error;

        const menuGrid = document.querySelector('.menu-grid');
        menuGrid.innerHTML = '';

        // ì‚¬ìš©ì—¬ë¶€ê°€ Yì¸ í™”ë©´ë§Œ í‘œì‹œ
        const screenMap = {
          'menu': { icon: 'ğŸ“‹', title: 'ë©”ë‰´ê´€ë¦¬' },
          'orders': { icon: 'ğŸ³', title: 'í…Œì´ë¸”ë³„ ì£¼ë¬¸í™•ì¸' },
          'food-kitchen': { icon: 'ğŸ½ï¸', title: 'ìŒì‹í™•ì¸(ì£¼ë°©)' },
          'food-serving': { icon: 'ğŸ½ï¸', title: 'ìŒì‹í™•ì¸(ì„œë¹™)' },
          'food-serving-table': { icon: 'ğŸ½ï¸', title: 'ì„œë¹™í™•ì¸(í…Œì´ë¸”)' },
          'orders-manager': { icon: 'ğŸ‘”', title: 'ë§¤ë‹ˆì €í™•ì¸(í…Œì´ë¸”)' },
          'food-manager': { icon: 'ğŸ‘”', title: 'ë§¤ë‹ˆì €í™•ì¸(ìŒì‹)' },
          'serving-history': { icon: 'ğŸ“œ', title: 'ì œê³µ íˆìŠ¤í† ë¦¬' },
          'payment': { icon: 'ğŸ’°', title: 'ê³„ì‚°' }
        };

        data.forEach(screen => {
          if (screen.use_yn === 'Y' && screenMap[screen.screen_key]) {
            const menuItem = document.createElement('div');
            menuItem.className = 'menu-item';
            menuItem.setAttribute('data-page', screen.screen_key);
            menuItem.innerHTML = `
              <div class="menu-item-icon">${screenMap[screen.screen_key].icon}</div>
              <div class="menu-item-title">${screenMap[screen.screen_key].title}</div>
            `;
            menuGrid.appendChild(menuItem);
          }
        });

        // í™”ë©´ê´€ë¦¬ ë©”ë‰´ëŠ” í•­ìƒ ë§¨ ë§ˆì§€ë§‰ì— í‘œì‹œ
        const screenManagementItem = document.createElement('div');
        screenManagementItem.className = 'menu-item';
        screenManagementItem.setAttribute('data-page', 'screen-management');
        screenManagementItem.innerHTML = `
          <div class="menu-item-icon">âš™ï¸</div>
          <div class="menu-item-title">í™”ë©´ê´€ë¦¬</div>
        `;
        menuGrid.appendChild(screenManagementItem);

        // í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
        const menuItems = document.querySelectorAll('.menu-item');
        menuItems.forEach(item => {
          item.addEventListener('click', () => {
            const page = item.dataset.page;
            window.location.href = `admin-${page}.html`;
          });
        });
      } catch (error) {
        console.error('ë©”ë‰´ ë¡œë“œ ì˜¤ë¥˜:', error);
        // ì˜¤ë¥˜ ë°œìƒ ì‹œ ê¸°ë³¸ ë©”ë‰´ í‘œì‹œ
        const defaultScreens = [
          { key: 'menu', icon: 'ğŸ“‹', title: 'ë©”ë‰´ê´€ë¦¬' },
          { key: 'orders', icon: 'ğŸ³', title: 'í…Œì´ë¸”ë³„ ì£¼ë¬¸í™•ì¸' },
          { key: 'food-kitchen', icon: 'ğŸ½ï¸', title: 'ìŒì‹í™•ì¸(ì£¼ë°©)' },
          { key: 'food-serving', icon: 'ğŸ½ï¸', title: 'ìŒì‹í™•ì¸(ì„œë¹™)' },
          { key: 'food-serving-table', icon: 'ğŸ½ï¸', title: 'ì„œë¹™í™•ì¸(í…Œì´ë¸”)' },
          { key: 'orders-manager', icon: 'ğŸ‘”', title: 'ë§¤ë‹ˆì €í™•ì¸(í…Œì´ë¸”)' },
          { key: 'food-manager', icon: 'ğŸ‘”', title: 'ë§¤ë‹ˆì €í™•ì¸(ìŒì‹)' },
          { key: 'serving-history', icon: 'ğŸ“œ', title: 'ì œê³µ íˆìŠ¤í† ë¦¬' },
          { key: 'payment', icon: 'ğŸ’°', title: 'ê³„ì‚°' },
          { key: 'screen-management', icon: 'âš™ï¸', title: 'í™”ë©´ê´€ë¦¬' }
        ];
        
        defaultScreens.forEach(screen => {
          const menuItem = document.createElement('div');
          menuItem.className = 'menu-item';
          menuItem.setAttribute('data-page', screen.key);
          menuItem.innerHTML = `
            <div class="menu-item-icon">${screen.icon}</div>
            <div class="menu-item-title">${screen.title}</div>
          `;
          menuGrid.appendChild(menuItem);
        });

        const menuItems = document.querySelectorAll('.menu-item');
        menuItems.forEach(item => {
          item.addEventListener('click', () => {
            const page = item.dataset.page;
            window.location.href = `admin-${page}.html`;
          });
        });
      }
    }

    // ì´ˆê¸° ë¡œë“œ
    loadMenuItems();
  </script>
</body>
</html>

